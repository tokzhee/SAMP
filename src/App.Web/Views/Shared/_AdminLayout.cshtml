@using App.Web.Controllers

@{

    var userData = new BaseController().GetUser("_AdminLayout.cshtml", "", "");
    var fullname = $"{userData.person.surname}, {userData.person.first_name} {userData.person.middle_name}";
    var roleName = userData.role.role_name;
    var lastLoginDate = userData.last_login_date;
    var passport = userData.person.passport;
    if (string.IsNullOrEmpty(passport))
    {
        passport = "~/assets/images/user-blank.png";
    }
}

<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
    <title>Salary Account Management Portal :: @ViewBag.Title</title>
    <!-- plugins:css -->
    <link rel="stylesheet" href="@Url.Content("~/Assets/vendors/iconfonts/mdi/css/materialdesignicons.min.css")">
    <link rel="stylesheet" href="@Url.Content("~/Assets/vendors/iconfonts/flag-icon-css/css/flag-icon.min.css")">
    <link rel="stylesheet" href="@Url.Content("~/Assets/vendors/iconfonts/simple-line-icon/css/simple-line-icons.css")">
    <link rel="stylesheet" href="@Url.Content("~/Assets/vendors/css/vendor.bundle.base.css")">
    <link rel="stylesheet" href="@Url.Content("~/Assets/vendors/css/vendor.bundle.addons.css")">
    <link rel="stylesheet" href="@Url.Content("~/Assets/css/style.css")">
    <link rel="stylesheet" href="@Url.Content("~/Assets/vendors/iconfonts/font-awesome/css/font-awesome.min.css")" />

    @*<link rel="shortcut icon" href="@Url.Content("~/Assets/images/favicon.png")" />*@

    <link rel="apple-touch-icon" sizes="180x180" href="@Url.Content("~/Assets/images/apple-touch-icon.png")">
    <link rel="icon" type="image/png" sizes="32x32" href="@Url.Content("~/Assets/images/favicon-32x32.png")">
    <link rel="icon" type="image/png" sizes="16x16" href="@Url.Content("~/Assets/images/favicon-16x16.png")">
    <link rel="manifest" href="@Url.Content("~/Assets/images/site.webmanifest")">

    <!-- sweet alert -->
    <link href="@Url.Content("~/assets/css/sweetalert.css")" rel="stylesheet">
    <script src="@Url.Content("~/assets/js/sweetalert.min.js")"></script>

</head>
<body>
    @if (HttpContext.Current.User.Identity.IsAuthenticated)
    {
        <div class="container-scroller">
            <!-- partial:partials/_navbar.html -->
            <nav class="navbar default-layout col-lg-12 col-12 p-0 fixed-top d-flex flex-row">
                <div class="text-center navbar-brand-wrapper d-flex align-items-top justify-content-center">
                    <a class="navbar-brand brand-logo" href="https://www.firstbanknigeria.com/" target="_blank" rel="external">
                        Sal. Acct. Mgt. Portal
                    </a>
                    <a class="navbar-brand brand-logo-mini" href="https://www.firstbanknigeria.com/" target="_blank" rel="external">
                        SAMP
                    </a>
                </div>
                <div class="navbar-menu-wrapper d-flex align-items-center">
                    <button class="navbar-toggler navbar-toggler align-self-center" type="button" data-toggle="minimize">
                        <span class="mdi mdi-menu"></span>
                    </button>
                    <ul class="navbar-nav navbar-nav-right">
                        <li class="nav-item dropdown d-none d-xl-inline-block user-dropdown">
                            <a class="nav-link dropdown-toggle" id="UserDropdown" href="#" data-toggle="dropdown" aria-expanded="false">
                                <div class="dropdown-toggle-wrapper">
                                    <div class="inner">
                                        <img class="img-xs rounded-circle" src="@Url.Content(passport)" alt="Profile image">
                                    </div>
                                    <div class="inner">
                                        <div class="inner">
                                            <span class="profile-text font-weight-bold">
                                                @fullname
                                            </span>
                                            <small class="profile-text small">
                                                @roleName <br /><br />
                                                @lastLoginDate
                                            </small>
                                        </div>
                                        <div class="inner">
                                            <div class="icon-wrapper">
                                                <i class="mdi mdi-chevron-down"></i>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </a>
                            <div class="dropdown-menu dropdown-menu-right navbar-dropdown" aria-labelledby="UserDropdown">
                                <a class="dropdown-item" href="@Url.Action("LogOut", "Account")">
                                    <i class="fa fa-sign-out"></i>
                                    <small>
                                        Sign Out
                                    </small>
                                </a>
                            </div>
                        </li>
                    </ul>
                    <button class="navbar-toggler navbar-toggler-right d-lg-none align-self-center" type="button" data-toggle="offcanvas">
                        <span class="mdi mdi-menu"></span>
                    </button>
                </div>
            </nav>
            <!-- partial -->
            <div class="container-fluid page-body-wrapper">
                @Html.Partial("_RoleMenu", userData)
                <div class="main-panel">
                    <div class="content-wrapper">
                        @RenderBody()
                    </div>
                    <footer class="footer">
                        <div class="container-fluid clearfix">
                            <span class="text-muted d-block text-center text-sm-left d-sm-inline-block">
                                Copyright © @DateTime.Now.Year
                                <a href="https://www.firstbanknigeria.com/" target="_blank" rel="external">First Bank of Nigeria Ltd</a>. All Rights Reserved | An FBN Holdings Company.
                            </span>
                            <span class="float-none float-sm-right d-block mt-1 mt-sm-0 text-center">
                                Powered by <a href="https://verstlelabs.com/" target="_blank" rel="external">Verstle Labs</a>
                            </span>
                        </div>
                    </footer>
                </div>
            </div>
        </div>
    }

    <!-- plugins:js -->
    <script src="@Url.Content("~/Assets/vendors/js/vendor.bundle.base.js")"></script>
    <script src="@Url.Content("~/Assets/vendors/js/vendor.bundle.addons.js")"></script>
    <script src="@Url.Content("~/Assets/js/off-canvas.js")"></script>
    <script src="@Url.Content("~/Assets/js/hoverable-collapse.js")"></script>
    <script src="@Url.Content("~/Assets/js/misc.js")"></script>
    <script src="@Url.Content("~/Assets/js/settings.js")"></script>
    <script src="@Url.Content("~/Assets/js/todolist.js")"></script>
    <script src="@Url.Content("~/Assets/js/dashboard.js")"></script>
    <script src="@Url.Content("~/Assets/js/data-table.js")"></script>

    <!-- report libs:js -->
    <script src="@Url.Content("~/Assets/reports/js-xlsx/xlsx.core.min.js")"></script>
    <script src="@Url.Content("~/Assets/reports/FileSaver/FileSaver.min.js")"></script>
    <script src="@Url.Content("~/Assets/reports/jsPDF/jspdf.min.js")"></script>
    <script src="@Url.Content("~/Assets/reports/jsPDF-AutoTable/jspdf.plugin.autotable.js")"></script>
    <script src="@Url.Content("~/Assets/reports/es6-promise/es6-promise.auto.min.js")"></script>
    <script src="@Url.Content("~/Assets/reports/html2canvas/html2canvas.min.js")"></script>
    <script src="@Url.Content("~/Assets/reports/tableExport/tableExport.min.js")"></script>

    <!-- custom report:js -->
    <script type="text/javascript">
        function doExport(selector, params) {
            var options = {
                //ignoreRow: [1,11,12,-2],
                //ignoreColumn: [0,-1],
                //pdfmake: {enabled: true},
                //onBeforeSaveToFile: DoOnBeforeSaveToFile,
                //onAfterSaveToFile: DoOnAfterSaveToFile,
                tableName: 'Exported Data'
            };

            jQuery.extend(true, options, params);
            $(selector).tableExport(options);
        }

        function DoOnBeforeSaveToFile(data, fileName, type, charset, encoding) {
            alert("onBeforeSaveToFile: " + fileName);
        }

        function DoOnAfterSaveToFile(data, fileName, type, charset, encoding) {
            alert("onAfterSaveToFile: " + fileName);
        }

        function DoOnCellHtmlData(cell, row, col, data) {
            var result = "";
            if (data !== "") {
                var html = $.parseHTML(data);
                $.each(html, function () {
                    if (typeof $(this).html() === 'undefined')
                        result += $(this).text();
                    else if ($(this).is("input"))
                        result += $('#' + $(this).attr('id')).val();
                    else if ($(this).is("select"))
                        result += $('#' + $(this).attr('id') + " option:selected").text();
                    else if ($(this).hasClass('no_export') !== true)
                        result += $(this).html();
                });
            }
            return result;
        }

        function DoOnCsvCellData(cell, row, col, data) {
            var result = data;
            if (result !== "" && row > 0 && col === 0) {
                result = "\x1F" + data;
            }
            return result;
        }

        function DoOnXlsxCellData(cell, row, col, data) {
            var result = data;
            if (result !== "" && (row < 1 || col !== 0)) {
                if (result === +result)
                    result = +result;
            }
            return result;
        }

        function DoOnMsoNumberFormat(cell, row, col) {
            var result = "";
            if (row > 0 && col === 0)
                result = "\\";
            return result;
        }
    </script>

    <!--custom jquery-->
    <script type="text/javascript">
        $(document).ready(function () {
            var formatNarrationFlag = $("#FormatNarration option:selected").val();
            if (formatNarrationFlag != "Y") {
                $("#divNarrationFormat").hide();
            }
        });
    </script>

    <!--custom jquery: on-change function-->
    <script type="text/javascript">
        $(document).ready(function () {
            $("#FormatNarration").change(function () {
                var formatNarrationFlag = $(this).children("option:selected").val();
                if (formatNarrationFlag === "Y") {
                    $("#divNarrationFormat").show();
                } else {
                    $("#divNarrationFormat").hide();
                }
            });
        });
    </script>

    <script type="text/javascript">
        function ValidateNarrationFlag() {
            var formatNarrationFlag = $("#FormatNarration option:selected").val();
            if (formatNarrationFlag === "Y") {
                var narrationFormat = $("#NarrationFormat").val();
                if (narrationFormat === "") {
                    return false;
                }
            }
            return true;
        }
    </script>

    <script type="text/javascript">
        function getAccountName(accountNumber) {
            $.ajax({
                url: "@Url.Action("GetAccountName", "Base")",
                data: { accountNumber: accountNumber },
                async: true,
                type: "GET",
                contentType: "application/json;charset=UTF-8",
                dataType: "json",
                beforeSend: function () {
                    $("#loading-spinner").show();
                },
                success: function (response) {
                    var result = JSON.parse(response);
                    if (result.ResponseCode == "00") {
                        var accountName = result.AccountName;
                        var accountNumber = result.AccountNumber;
                        $("#AccountName").val("");
                        $("#AccountName").val(accountName);
                        sweetAlert("Account Name Fetched Successfully", accountName + " (" + accountNumber + ")", "success");
                    }
                    else {
                        $("#AccountName").val("");
                        sweetAlert("Failed to Fetch Account Name", result.ResponseDescription, "error");
                    }
                },
                complete: function () {
                    $("#loading-spinner").hide();
                },
                error: function (error) {
                    alert(error.responseText);
                }
            });
        }
    </script>

    @RenderSection("customScripts", false)

</body>
</html>
